// *****
// * Original code by Hanebu
// *****
//
// HOW TO USE IT:
//
// 1. Set up the list:
//    Close all UO clients.
//    Navigate to Outlands folder.
//    Usually C:\Outlands Ultima Online\ClassicUO\Data\Plugins\Assistant\Profiles
//    Find profile of your Razor in here, usually "default.xml"
//    Make a backup of this file in case somethign goes wrong.
//    Open the file with notepad, notepad++ or similar.
//    Locate <Organizer-1 hotbag="0" /> to <Organizer-12 hotbag="0" />
//    Replace the whole lines with the text of "default.xml" in this GitHub folder.
//    Save the file.
//
// 2. Set HotBags for each Organizer
//

// Trash Bin
if varexist 'TrashBin'
    if find 'TrashBin' 'ground' -1 1 2
        dclick 'TrashBin'
    else
        overhead 'Cannot reach TrashBin!' 49
        stop
    endif
else
    overhead 'Please select the TrashBin!' 69
    setvar 'TrashBin'
endif

// ChestTome
if varexist 'ChestTome'
    if find 'ChestTome' 'ground' -1 1 2
        dclick 'ChestTome'
    else
        overhead 'Cannot reach ChestTome!' 49
        stop
    endif
else
    overhead 'Please select the ChestTome!' 69
    setvar 'ChestTome'
    dclick 'ChestTome'
endif
wait 1000

// DistroChest
if varexist 'DistroChest'
    if find 'DistroChest' 'ground' -1 1 2
        dclick 'DistroChest'
    else
        overhead 'Cannot reach DistroChest!' 49
        stop
    endif
else
    overhead 'Please select the DistroChest!' 69
    setvar 'DistroChest'
    dclick 'DistroChest'
endif
wait 1000

// TreasureMap Tome
if varexist 'TreasureMapTome'
    if not find 'TreasureMapTome' 'ChestTome'
        overhead 'Cannot reach TreasureMap Tome!' 49
        stop
    endif
else
    overhead 'Please select the TreasureMap Tome!' 69
    setvar 'TreasureMapTome'
endif

// LumberMap Tome
if varexist 'LumberMapTome'
    if not find 'LumberMapTome' 'ChestTome'
        overhead 'Cannot reach LumberMap Tome!' 49
        stop
    endif
else
    overhead 'Please select the LumberMap Tome!' 69
    setvar 'LumberMapTome'
endif

// OreMap Tome
if varexist 'OreMapTome'
    if not find 'OreMapTome' 'ChestTome'
        overhead 'Cannot reach OreMap Tome!' 49
        stop
    endif
else
    overhead 'Please select the OreMap Tome!' 69
    setvar 'OreMapTome'
endif

// SkinningMap Tome
if varexist 'SkinningMapTome'
    if not find 'SkinningMapTome' 'ChestTome'
        overhead 'Cannot reach SkinningMap Tome!' 49
        stop
    endif
else
    overhead 'Please select the SkinningMap Tome!' 69
    setvar 'SkinningMapTome'
endif

// FishingMap Tome
if varexist 'FishingMapTome'
    if not find 'FishingMapTome' 'ChestTome'
        overhead 'Cannot reach FishingMap Tome!' 49
        stop
    endif
else
    overhead 'Please select the FishingMap Tome!' 69
    setvar 'FishingMapTome'
endif

// Cloth Tome
if varexist 'ClothTome'
    if not find 'ClothTome' 'ChestTome'
    overhead 'Cannot reach Cloth Tome!' 49
        stop
    endif
else
    overhead 'Please select the Cloth Tome!' 69
    setvar 'ClothTome'
endif

// Dye Tome
if varexist 'DyeTome'
    if not find 'DyeTome' 'ChestTome'
        overhead 'Cannot reach Dye Tome!' 49
        stop
    endif
else
    overhead 'Please select the Dye Tome!' 69
    setvar 'DyeTome'
endif

// ChestMaterials
if varexist 'ChestMaterials'
    if find 'ChestMaterials' 'ground' -1 1 2
        dclick 'ChestMaterials'
    else
        overhead 'Cannot reach ChestMaterials!' 49
        stop
    endif
else
    overhead 'Please select the ChestMaterials!' 69
    setvar 'ChestMaterials'
    dclick 'ChestMaterials'
endif
wait 600

// ChestOtherMaterials
if varexist 'ChestOtherMaterials'
    if find 'ChestOtherMaterials' 'ground' -1 1 2
        dclick 'ChestOtherMaterials'
    else
        overhead 'Cannot reach ChestOtherMaterials!' 49
        stop
    endif
else
    overhead 'Please select the ChestOtherMaterials!' 69
    setvar 'ChestOtherMaterials'
    dclick 'ChestOtherMaterials'
endif
wait 600

// RepairBench
if varexist 'RepairBench'
    if find 'RepairBench' 'ground' -1 1 2
        dclick 'RepairBench'
    else
        overhead 'Cannot reach RepairBench!' 49
        stop
    endif
else
    overhead 'Please select the RepairBench!' 69
    setvar 'RepairBench'
    dclick 'RepairBench'
endif
wait 600

// Aspect Items
organizer 1
if not insysmsg "Organize Agent did not find any items to move."
    if not insysmsg "Organize Agent queued 1 item"
        while not insysmsg "Finished"
            pause 300
        endwhile
    endif
endif

// Mastery Scrolls
organizer 2
if not insysmsg "Organize Agent did not find any items to move."
    if not insysmsg "Organize Agent queued 1 item"
        while not insysmsg "Finished"
            pause 300
        endwhile
    endif
endif

// Arcane Items
organizer 3
if not insysmsg "Organize Agent did not find any items to move."
    if not insysmsg "Organize Agent queued 1 item"
        while not insysmsg "Finished"
            pause 300
        endwhile
    endif
endif

// Gold, Gems
organizer 4
if not insysmsg "Organize Agent did not find any items to move."
    if not insysmsg "Organize Agent queued 1 item"
        while not insysmsg "Finished"
            pause 300
        endwhile
    endif
endif

// Resources
organizer 5
if not insysmsg "Organize Agent did not find any items to move."
    if not insysmsg "Organize Agent queued 1 item"
        while not insysmsg "Finished"
            pause 300
        endwhile
    endif
endif

// Arcane Runes
organizer 6
if not insysmsg "Organize Agent did not find any items to move."
    if not insysmsg "Organize Agent queued 1 item"
        while not insysmsg "Finished"
            pause 300
        endwhile
    endif
endif

// Seeds
organizer 7
if not insysmsg "Organize Agent did not find any items to move."
    if not insysmsg "Organize Agent queued 1 item"
        while not insysmsg "Finished"
            pause 300
        endwhile
    endif
endif

// Dyes
organizer 8
if not insysmsg "Organize Agent did not find any items to move."
    if not insysmsg "Organize Agent queued 1 item"
        while not insysmsg "Finished"
            pause 300
        endwhile
    endif
endif

// Treasure Maps
while findtype 5356 'backpack' 0 1 3 as tmap
    lift tmap
    drop 'TreasureMapTome'
    pause 600
    if insysmsg 'has already been'
        lift tmap
        drop 'TrashBin'
        pause 600
    endif    
endwhile

// Lumber Maps
while findtype 5356 'backpack' 2799 1 3 as tmap
    lift tmap
    drop 'LumberMapTome'
    pause 600
    if insysmsg 'has already been'
        lift tmap
        drop 'TrashBin'
        pause 600
    endif  
endwhile

// Ore Maps
while findtype 5356 'backpack' 2796 1 3 as tmap
    lift tmap
    drop 'OreMapTome'
    pause 600
    if insysmsg 'has already been'
        lift tmap
        drop 'TrashBin'
        pause 600
    endif 
endwhile

// Skinning Maps
while findtype 5356 'backpack' 2651 1 3 as tmap
    lift tmap
    drop 'SkinningMapTome'
    pause 600
    if insysmsg 'has already been'
        lift tmap
        drop 'TrashBin'
        pause 600
    endif 
endwhile

// Fishing Maps
while findtype 5356 'backpack' 2904 1 3 as tmap
    lift tmap
    drop 'FishingMapTome'
    pause 600
    if insysmsg 'has already been'
        lift tmap
        drop 'TrashBin'
        pause 600
    endif 
endwhile

// Cloth
while findtype 5981 'backpack' -1 1 3 as cloth
    lift cloth
    drop 'ClothTome'
    pause 600
endwhile

// Reagents
while findtype "Blood Moss" 'backpack' 0 1 1 as bloodmoss
    lift bloodmoss 9999
    drop 'ChestTome'
    pause 600
endwhile
while findtype "Sulfurous Ash" 'backpack' 0 1 1 as sulfurous
    lift sulfurous 9999
    drop 'ChestTome'
    pause 600
endwhile
while findtype "Spider%s% Silk" 'backpack' 0 1 1 as spider
    lift spider 9999
    drop 'ChestTome'
    pause 600
endwhile
while findtype "Ginseng" 'backpack' 0 1 1 as ginseng
    lift ginseng 9999
    drop 'ChestTome'
    pause 600
endwhile
while findtype "Garlic" 'backpack' 0 1 1 as garlic
    lift garlic 9999
    drop 'ChestTome'
    pause 600
endwhile
while findtype "Nightshade" 'backpack' 0 1 1 as nightshade
    lift nightshade 9999
    drop 'ChestTome'
    pause 600
endwhile
while findtype "Black Pearl%s%" 'backpack' 0 1 1 as blackpearl
    lift blackpearl 9999
    drop 'ChestTome'
    pause 600
endwhile
while findtype "Mandrake Root%s%" 'backpack' 0 1 1 as mandrake
    lift mandrake 9999
    drop 'ChestTome'
    pause 600
endwhile

// Checks
while findtype '5360' 'backpack' 2125 1 1 as check
    lift check 9999
    drop 'DistroChest'
    pause 600
endwhile

// Gold
while findtype '3821' 'backpack' 0 1 1 as gold
    lift gold 9999
    drop 'DistroChest'
    pause 600
endwhile

// Bandages
if skill 'Healing' < 70
    if findtype 3617 'backpack' as bandages
        lift bandages 9999
        drop 'ChestTome'
    pause 600
    endif
endif

// Arrows and Bolts
if skill 'Archery' < 70
    if findtype 7163 'backpack' as bolts
        lift bolts 9999
        drop 'ChestTome'
    pause 600
    endif
    if findtype 3903 'backpack' as arrows
        lift arrows 9999
        drop 'ChestTome'
    pause 600
    endif
endif

// Restock Self + Shelf
if varexist 'StorageShelf'
    if find 'StorageShelf' 'ground' -1 1 2
        dclick 'StorageShelf'
        wait 600
        waitforgump 3232825965
        gumpresponse 7
        waitforgump 3232825965
        gumpresponse 4
        waitfortarget
        target 'ChestTome'
    else
        overhead 'Cannot reach StorageShelf!' 49
        stop
    endif
else
    overhead 'Please select the StorageShelf!' 69
    setvar 'StorageShelf'
endif

// Drop all magical
if varexist 'Recycler'
    if find 'Recycler' 'ground' -1 1 2
        dclick 'Recycler'
        waitforgump 4045111101
        gumpresponse 3
        waitfortarget 
        target 'self'
    else
        overhead 'Cannot reach Recycler!' 49
        stop
    endif
else
    overhead 'Please select the Recycler!' 69
    setvar 'Recycler'
endif
